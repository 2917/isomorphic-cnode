webpackJsonp([3],{277:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,a){try{var i=t[o](a),u=i.value}catch(c){return void r(c)}return i.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(c){o=!0,a=c}finally{try{!n&&u["return"]&&u["return"]()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=r(262),p=o(l),f=r(278),y=o(f),h=r(279),v=n(h),d=r(267),b=function(e){function t(){var e,r,n,o;i(this,t);for(var c=arguments.length,l=Array(c),p=0;p<c;p++)l[p]=arguments[p];return r=n=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.name="Detail",n.View=y["default"],n.actions=v,n.initialState={showMenu:!1,topic:null,curReplyId:null,replyToReply:"",replyToTopic:"",suffix:'\n        <br/>\n        来自 <a class="from" href="https://github.com/Lucifier129/isomorphic-cnode">isomorphic-cnode</a>\n        '},n.methods={openMenu:d.openMenu,closeMenu:d.closeMenu,updateReplyToReply:function(e){var t=e.currentTarget,r=this.store.actions.UPDATE_FIELD,n=t.value;r({key:"replyToReply",value:n})},updateReplyToTopic:function(e){var t=e.currentTarget,r=this.store.actions.UPDATE_FIELD,n=t.value;r({key:"replyToTopic",value:n})},isLogin:function(){var e=this.store.getState(),t=e.userInfo,r=e.location;return!!t.id||(this.goTo("/login?redirect="+r.raw),!1)},upReply:function(e){var t=this,r=e.currentTarget;return a(regeneratorRuntime.mark(function n(){var e,o,a,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.isLogin()){n.next=2;break}return n.abrupt("return");case 2:return e=t.store.actions,o=e.UPDATE_FIELD,a=e.UPS_REPLAY,i=r.getAttribute("data-id"),n.prev=6,n.next=9,a(i);case 9:n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](6),alert(n.t0.message);case 14:case"end":return n.stop()}},n,t,[[6,11]])}))()},showReply:function(e){var t=e.currentTarget;if(this.isLogin()){var r=this.store.actions.UPDATE_FIELDS,n=this.store.getState(),o=n.curReplyId,a=n.topic,i=t.getAttribute("data-id"),u=a.replies.filter(function(e){return e.id===i}),c=s(u,1),l=c[0].author;o!==i&&r([{key:"curReplyId",value:i},{key:"replyToReply",value:"@"+l.loginname+" "}])}},addReply:function(e){var t=this,r=e.currentTarget;return a(regeneratorRuntime.mark(function n(){var e,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.isLogin()){n.next=2;break}return n.abrupt("return");case 2:return e=t.store.actions.ADD_REPLY,o=r.getAttribute("data-reply"),n.prev=4,n.next=7,e(o);case 7:n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](4),alert(n.t0.message);case 12:case"end":return n.stop()}},n,t,[[4,9]])}))()}},o=r,u(n,o)}return c(t,e),t}(p["default"]);t["default"]=b}});