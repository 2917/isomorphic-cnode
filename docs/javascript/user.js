webpackJsonp([4],{265:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(a,o){try{var s=t[a](o),u=s.value}catch(c){return void r(c)}return s.done?void e(u):Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.readPic=t.addReply=t.upsReply=t.markAllMessages=t.getMessages=t.addTopic=t.getUserData=t.getUserInfo=t.getTopic=t.getTopics=void 0;var s=r(266),u=n(s),c=r(206),i="https://cnodejs.org/api/v1",l=(0,c.createFetchJSON)(i);t.getTopics=function(e){return l("/topics?"+u["default"].stringify(e))},t.getTopic=function(e){return l("/topic/"+e)},t.getUserInfo=function(){var e=o(regeneratorRuntime.mark(function t(e){var r,n,o,s,c,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r="/accesstoken",n={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:u["default"].stringify({accesstoken:e})},t.next=4,l(r,n);case 4:if(o=t.sent,s=o.success,c=o.error_msg,i=a(o,["success","error_msg"]),s){t.next=10;break}throw new Error(c);case 10:return t.abrupt("return",i);case 11:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getUserData=function(){var e=o(regeneratorRuntime.mark(function t(e){var r,n,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l("/user/"+e);case 2:if(r=t.sent,n=r.success,a=r.error_msg,o=r.data,n){t.next=8;break}throw new Error(a);case 8:return t.abrupt("return",o);case 9:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.addTopic=function(){var e=o(regeneratorRuntime.mark(function t(e){var r,n,a,o,s,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r="/topics",n={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:u["default"].stringify(e)},t.next=4,l(r,n);case 4:if(a=t.sent,o=a.success,s=a.error_msg,c=a.topic_id,o){t.next=10;break}throw new Error(s);case 10:return t.abrupt("return",c);case 11:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getMessages=function(){var e=o(regeneratorRuntime.mark(function t(e){var r,n,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r="/messages?accesstoken="+e,t.next=3,l(r);case 3:if(n=t.sent,a=n.success,o=n.error_msg,s=n.data,a){t.next=9;break}throw new Error(o);case 9:return t.abrupt("return",s);case 10:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.markAllMessages=function(){var e=o(regeneratorRuntime.mark(function t(e){var r,n,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r="/message/mark_all",n={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:u["default"].stringify({accesstoken:e})},t.next=4,l(r,n);case 4:if(a=t.sent,o=a.success){t.next=8;break}throw new Error(error_msg);case 8:return t.abrupt("return",o);case 9:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.upsReply=function(){var e=o(regeneratorRuntime.mark(function t(e){var r,n,a,o,s,c,i=e.replyId,f=e.accesstoken;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="/reply/"+i+"/ups",n={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:u["default"].stringify({accesstoken:f})},e.next=4,l(r,n);case 4:if(a=e.sent,o=a.success,s=a.action,c=a.error_msg,o){e.next=10;break}throw new Error(c);case 10:return e.abrupt("return",s);case 11:case"end":return e.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.addReply=function(){var e=o(regeneratorRuntime.mark(function t(e){var r,n,a,o,s,c,i,f=e.topicId,p=e.accesstoken,d=e.content,m=e.replyId;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="/topic/"+f+"/replies",n={accesstoken:p,content:d},m&&(n.reply_id=m),a={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:u["default"].stringify(n)},e.next=6,l(r,a);case 6:if(o=e.sent,s=o.success,c=o.error_msg,i=o.reply_id,s){e.next=12;break}throw new Error(c);case 12:return e.abrupt("return",i);case 13:case"end":return e.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.readPic=function(){var e=o(regeneratorRuntime.mark(function t(e){var r,n,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r="http://m.yueqingwang.com/common.ashx",n={method:"POST",body:JSON.stringify({img:e})},t.next=4,fetch(r,n);case 4:return a=t.sent,t.next=7,a.text();case 7:if(o=t.sent,"qrcode error"===o){t.next=10;break}throw new Error("二维码图片不清晰");case 10:return t.abrupt("return",o);case 11:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}()},287:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=r(194),i=a(c),l=r(288),f=a(l),p=r(289),d=n(p),m=r(269),v=function(e){function t(){var e,r,n,a;o(this,t);for(var u=arguments.length,c=Array(u),i=0;i<u;i++)c[i]=arguments[i];return r=n=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),n.name="User",n.View=f["default"],n.actions=d,n.initialState={showMenu:!1,user:{},selectItem:"replies",currentData:[]},n.methods={openMenu:m.openMenu,closeMenu:m.closeMenu,changeItem:function(e){var t=e.currentTarget,r=this.store.actions.UPDATE_FIELD,n=t.getAttribute("data-type");r({key:"selectItem",value:n})}},a=r,s(n,a)}return u(t,e),t}(i["default"]);t["default"]=v},288:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e){var t=e.state,r=e.methods,n=t.showMenu,a=t.user,u=t.selectItem,i=t.userInfo,p=t.location,m=r.openMenu,v=r.closeMenu,g=r.changeItem,h=a["recent_"+u]||[];return c["default"].createElement("div",{style:{height:"100%",background:"#fff"}},c["default"].createElement(d["default"],{pageType:"用户信息",fixHead:!0,needAdd:!0,showMenu:n,openMenu:m,closeMenu:v,userInfo:i,location:p}),c["default"].createElement("section",{className:"userinfo"},c["default"].createElement("img",{className:"u-img",src:a.avatar_url}),c["default"].createElement("br",null),c["default"].createElement("span",{className:"u-name"},a.loginname),c["default"].createElement("div",{className:"u-bottom"},c["default"].createElement("span",{className:"u-time"},(0,f.getLastTimeStr)(a.create_at,!1)),c["default"].createElement("span",{className:"u-score"},"积分：",a.score))),c["default"].createElement("section",{className:"topics"},c["default"].createElement("ul",{className:"user-tabs"},c["default"].createElement("li",{className:(0,l["default"])({item:!0,br:!0,selected:"replies"===u}),"data-type":"replies",onClick:g},"最近回复"),c["default"].createElement("li",{className:(0,l["default"])({item:!0,br:!0,selected:"topics"===u}),"data-type":"topics",onClick:g},"最新发布")),h.length>0&&h.map(function(e){return c["default"].createElement(o,s({},e,{key:e.id}))}),0===h.length&&c["default"].createElement("div",{className:"no-data"},c["default"].createElement("i",{className:"iconfont icon-empty"},""),"暂无数据!")))}function o(e){var t=e.id,r=e.title,n=e.author,a=e.last_reply_at;return c["default"].createElement("div",{className:"message markdown-body"},c["default"].createElement("section",{className:"user"},c["default"].createElement(v["default"],{tagName:"img",className:"head",src:n.avatar_url,to:"/user/"+n.loginname}),c["default"].createElement(v["default"],{tagName:"div",to:"/topic/"+t},c["default"].createElement("div",{className:"t-title"},r),c["default"].createElement("span",{className:"cl"},c["default"].createElement("span",{className:"name"},n.loginname)),c["default"].createElement("span",{className:"cr"},c["default"].createElement("span",{className:"name"},(0,f.getLastTimeStr)(a,!0))))))}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t["default"]=a;var u=r(195),c=n(u),i=r(259),l=n(i),f=r(206),p=r(258),d=n(p),m=r(261),v=n(m)},289:function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(a,o){try{var s=t[a](o),u=s.value}catch(c){return void r(c)}return s.done?void e(u):Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.UPDATE_FIELD=t.INIT=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=r(265);t.INIT=function(){var e=a(regeneratorRuntime.mark(function t(e){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.location.params.loginname,t.next=3,(0,s.getUserData)(r);case 3:return n=t.sent,t.abrupt("return",o({},e,{user:n}));case 5:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.UPDATE_FIELD=function(e,t){var r=t.key,a=t.value;return e[r]===a?e:o({},e,n({},r,a))}}});